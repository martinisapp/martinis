# ========================================
# Martinis Application Configuration
# Optimized for Railway.com Deployment
# Spring Boot 3.2.0
# ========================================

# ========================================
# Application Metadata
# ========================================
spring.application.name=martinis
spring.application.description=Professional Screenplay Management System

# ========================================
# Server Configuration
# ========================================
server.port=${PORT:8080}
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024
server.http2.enabled=true

# Graceful shutdown
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s

# ========================================
# JSP View Configuration
# ========================================
spring.mvc.view.prefix=/WEB-INF/jsp/
spring.mvc.view.suffix=.jsp

# ========================================
# Database Configuration (Railway)
# ========================================
# Railway automatically provides DATABASE_URL in format:
# mysql://user:password@host:port/database
# DatabaseConfig.java handles URL parsing and conversion
spring.datasource.url=${DATABASE_URL:jdbc:mysql://localhost:3306/martinis?useSSL=false&serverTimezone=UTC}
spring.datasource.driver-class-name=${DB_DRIVER:com.mysql.cj.jdbc.Driver}

# HikariCP Connection Pool
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# ========================================
# SQL Initialization
# ========================================
# Auto-run schema.sql on first startup
spring.sql.init.mode=${SQL_INIT_MODE:always}
spring.sql.init.continue-on-error=false
spring.sql.init.encoding=UTF-8

# ========================================
# File Upload Configuration
# ========================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=50MB
spring.servlet.multipart.file-size-threshold=2KB

# ========================================
# Jackson JSON Configuration
# ========================================
spring.jackson.serialization.indent-output=true
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=UTC

# ========================================
# Security Configuration
# ========================================
# BCrypt password encoding strength
spring.security.password.bcrypt.rounds=10

# ========================================
# Logging Configuration
# ========================================
logging.level.root=INFO
logging.level.com.chriswatnee.martinis=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=INFO
logging.level.com.zaxxer.hikari=INFO

# Logging pattern for Railway
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# ========================================
# Actuator / Management Endpoints
# ========================================
management.endpoints.enabled-by-default=false
management.endpoint.health.enabled=true
management.health.defaults.enabled=true

# ========================================
# Performance & Production Settings
# ========================================
# Template caching
spring.web.resources.cache.cachecontrol.max-age=3600
spring.web.resources.chain.cache=true

# Disable unnecessary features in production
spring.jmx.enabled=false
spring.devtools.restart.enabled=false

# ========================================
# Railway-Specific Environment Variables
# ========================================
# PORT - Automatically provided by Railway
# DATABASE_URL - MySQL connection URL from Railway
# ADMIN_USERNAME - Initial admin username
# ADMIN_PASSWORD - Initial admin password
# ADMIN_FIRSTNAME - Admin first name
# ADMIN_LASTNAME - Admin last name

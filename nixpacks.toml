[phases.setup]
nixPkgs = ["maven", "jdk8"]

[phases.build]
cmds = [
  "mvn -v",
  "mvn clean package -DskipTests -Dmaven.wagon.http.retryHandler.count=3"
]

[phases.start]
cmd = "java $JAVA_OPTS -jar target/dependency/webapp-runner.jar --port $PORT target/*.war"

[variables]
MAVEN_OPTS = "-Xmx1024m -Xms512m"
JAVA_OPTS = "-Xmx512m"
